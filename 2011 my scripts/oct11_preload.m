% PepList=[1 	10 	1	1149.5759 
% 1 	10 	2 	575.2916
% 5 	10 	1	698.3580 
% 5 	12 	1	973.5214 
% 11 	20 	1	1226.6052 
% 11 	20 	2 	613.8062
% 13 	20 	1	951.4418 
% 42 	51 	1	1149.6150 
% 42 	51 	2 	575.3111
% 52 	64 	1	1498.5784 
% 52 	64 	2 	749.7929
% 65 	73 	1	1017.5364 
% 65 	73 	2 	509.2718
% 74 	81 	1	933.5186 
% 82 	93 	1	1434.5334 
% 82 	93 	2 	717.7703
% 94 	98 	1	658.3155 
% 94 	106 	1	1714.7966 
% 94 	106 	2 	857.9019
% 94 	106 	3 	572.2704
% 99 	106 	1	1075.4989 
% 99 	106 	2 	538.2531
% 107 	114 	1	940.4483 
% 137 	144 	1	1055.5884 
% 137 	144 	2 	528.2978
% 138 	144 	1	927.4934 
% 138 	145 	1	1083.5946 
% 138 	145 	2 	542.3009
% 146 	159 	1	1742.8941 
% 146 	159 	2 	871.9507
% 146 	159 	3 	581.6362
% 161 	174 	1	1662.7251 
% 161 	174 	2 	831.8662
% 161 	174 	3 	554.9132
% 163 	174 	1	1371.5668 
% 163 	174 	2 	686.287
% 175 	181 	1	772.4386 
% 175 	186 	1	1398.7773 
% 175 	186 	2 	699.8923
% 182 	186 	1	645.3566 
% 182 	190 	1	1074.5426 
% 182 	190 	2 	537.7749
% 187 	195 	1	892.4371 
% 191 	197 	1	747.4108 
% 198 	205 	1	947.5343 
% 200 	205 	1	706.3552 
% 200 	209 	1	1195.5888 
% 200 	209 	2 	598.298
% 206 	212 	1	854.4519 
% 210 	218 	1	1019.5785 
% 210 	218 	2 	510.2929
% 213 	218 	1	673.3780 
% 213 	222 	1	1157.6538 
% 213 	222 	2 	579.3305
% 219 	225 	1	875.5098 
% 223 	233 	1	1252.6572 
% 223 	233 	2 	626.8322
% 226 	233 	1	880.4411 
% 226 	240 	1	1650.8949 
% 226 	240 	2 	825.9511
% 226 	240 	3 	550.9698
% 234 	240 	1	789.4716 
% 258 	262 	1	517.2980 
% 263 	274 	1	1443.6420 
% 263 	274 	2 	722.3247
% 263 	276 	1	1684.8211 
% 263 	276 	2 	842.9142
% 263 	276 	3 	562.2785
% 275 	286 	1	1546.7968 
% 275 	286 	2 	773.902
% 275 	286 	3 	516.2704
% 277 	286 	1	1305.6177 
% 277 	286 	2 	653.3125
% 314 	323 	1	1197.5568 
% 314 	323 	2 	599.2821
% 318 	323 	1	695.3359 
% 324 	336 	1	1623.7876 
% 324 	336 	2 	812.3974
% 324 	337 	1	1779.8887 
% 324 	337 	2 	890.448
% 324 	337 	3 	593.9677
% 337 	348 	1	1467.8431 
% 337 	348 	2 	734.4252
% 338 	348 	1	1311.7419 
% 338 	348 	2 	656.3746
% 338 	351 	1	1623.9581 
% 338 	351 	2 	812.4827
% 338 	351 	3 	541.9909
% 349 	359 	1	1296.7046 
% 349 	359 	2 	648.8559
% 352 	359 	1	984.4884 
% 360 	372 	1	1552.5977 
% 360 	372 	2 	776.8025
% 360 	372 	3 	518.2041
% 390 	402 	1	1657.7526 
% 390 	402 	2 	829.38
% 403 	410 	1	960.5625 
% 403 	413 	1	1352.7685 
% 403 	413 	2 	676.8879
% 414 	428 	1	1639.9377 
% 414 	428 	2 	820.4725
% 414 	428 	3 	547.3174
% 415 	428 	1	1511.8428 
% 415 	428 	2 	756.425
% 429 	436 	1	802.4781 
% 433 	439 	1	838.3910 
% 437 	444 	1	1029.4604 
% 437 	444 	2 	515.2339
% 440 	444 	1	581.3042 
% 440 	445 	1	737.4053 
% 467 	472 	1	674.3468 
% 467 	475 	1	1002.5578 
% 467 	475 	2 	501.7826
% 473 	484 	1	1466.7090 
% 473 	484 	2 	733.8581
% 476 	484 	1	1138.4980 
% 476 	484 	2 	569.7526
% 520 	524 	1	673.3991 
% 525 	534 	1	1128.6987 
% 525 	534 	2 	564.853
% 526 	534 	1	1000.6037 
% 526 	534 	2 	500.8055
% 526 	538 	1	1490.9053 
% 526 	538 	2 	745.9563
% 535 	541 	1	809.4992 
% 539 	545 	1	817.4778 
% 546 	557 	1	1342.6348 
% 546 	557 	2 	671.821
% 546 	560 	1	1790.7910 
% 546 	560 	2 	895.8992
% 546 	560 	3 	597.6019
% 558 	564 	1	896.3601 
% 561 	573 	1	1499.6319 
% 561 	573 	2 	750.3196
% 561 	573 	3 	500.5488
% 565 	573 	1	1070.4459 
% 565 	573 	2 	535.7266
% 565 	574 	1	1198.5409 
% 565 	574 	2 	599.7741
% 574 	585 	1	1141.6939 
% 574 	585 	2 	571.3506
% 575 	585 	1	1013.5990 
% ];

PepList=[13 	20 	1	951.4418 
42 	51 	2 	575.3111
52 	64 	2 	749.7929
65 	73 	2 	509.2718
74 	81 	1	933.5186 
82 	93 	2 	717.7703
99 	106 	2 	538.2531
107 	114 	1	940.4483 
138 	144 	1	927.4934 
146 	159 	3 	581.6362
163 	174 	2 	686.287
175 	181 	1	772.4386 
182 	186 	1	645.3566 
213 	218 	1	673.3780 
226 	233 	1	880.4411 
234 	240 	1	789.4716 
263 	274 	2 	722.3247
277 	286 	2 	653.3125
318 	323 	1	695.3359 
324 	336 	2 	812.3974
338 	348 	2 	656.3746
352 	359 	1	984.4884 
360 	372 	3 	518.2041
390 	402 	2 	829.38
403 	410 	1	960.5625 
415 	428 	2 	756.425
476 	484 	2 	569.7526
526 	534 	2 	500.8055
546 	557 	2 	671.821
575 	585 	1	1013.5990 
];

proteinName='1BMO';
currSeq='DAHKSEVAHRFKDLGEENFKALVLIAFAQYLQQCPFEDHVKLVNEVTEFAKTCVADESAENCDKSLHTLFGDKLCTVATLRETYGEMADCCAKQEPERNECFLQHKDDNPNLPRLVRPEVDVMCTAFHDNEETFLKKYLYEIARRHPYFYAPELLFFAKRYKAAFTECCQAADKAACLLPKLDELRDEGKASSAKQRLKCASLQKFGERAFKAWAVARLSQRFPKAEFAEVSKLVTDLTKVHTECCHGDLLECADDRADLAKYICENQDSISSKLKECCEKPLLEKSHCIAEVENDEMPADLPSLAADFVESKDVCKNYAEAKDVFLGMFLYEYARRHPDYSVVLLLRLAKTYETTLEKCCAAADPHECYAKVFDEFKPLVEEPQNLIKQNCELFEQLGEYKFQNALLVRYTKKVPQVSTPTLVEVSRNLGKVGSKCCKHPEAKRMPCAEDYLSVVLNQLCVLHEKTPVSDRVTKCCTESLVNRRPCFSALEVDETYVPKEFNAETFTFHADICTLSEKERQIKKQTALVELVKHKPKATKEQLKAVMDDFAAFVEKCCKADDKETCFAEEGKKLVAASQAALGL';

XN=2;
peptidesPool=[];
peptidesPool_distND={};

for i=1:size(PepList,1)
    subSeq=currSeq(PepList(i,1):PepList(i,2));
    [peptideMass, distND, maxND, maxD]=pepinfo(subSeq, XN); %call my function pepinfo.m
    peptidesPool(i,1)=PepList(i,1);
    peptidesPool(i,2)=PepList(i,2);
    peptidesPool(i,3)=PepList(i,3);
    peptidesPool(i,4)=PepList(i,4); %unmodified should=peptideMass/peptidesPool(i,3)+1.007276; %m/z of mono; 1.007276 is the mass of proton
    peptidesPool(i,5)=maxND; %the observable isotope peaks number of this peptide of ND(allH) sample
    peptidesPool(i,6)=maxD; %the exchangable amide hydrogens number of this peptide
    peptidesPool(i,7)=22.5;
    peptidesPool(i,8)=0;
    peptidesPool_distND{i}=distND;
end

h=poolplot1(peptidesPool); %call poolplot1.m
SaveFigureName=[proteinName '_ExMS_preload(' date ')_peptidesPool.fig'];
saveas(h,SaveFigureName)

mzThreshold=20; %input('Input m/z threshold (in ppm) for finding isobaric peptides (e.g. 20): ');
peptidesPool_isobaricTable=[];
n=1;
for i=1:size(peptidesPool,1)
    START=peptidesPool(i,1);
    END=peptidesPool(i,2);
    Charge=peptidesPool(i,3);
    isobaricPeptides=simpep(START, END, Charge, peptidesPool, 1, mzThreshold); %call simpep.m
    if size(isobaricPeptides,1)>1
        peptidesPool_isobaricTable(n,1:8)=peptidesPool(i,:);
        peptidesPool_isobaricTable(n,9)=i; %index in 'peptidesPool'
        peptidesPool_isobaricTable=sortrows(peptidesPool_isobaricTable,4); %sort by m/z
        n=n+1;
    end
end



flagTheor=0; 



%%%save all above variables to a file for later use:
SaveFileName=[proteinName '_ExMS_preload(' date ')_ShortList.mat'];
save(SaveFileName,'proteinName','currSeq','peptidesPool','peptidesPool_distND','flagTheor')

        

disp(' ')
disp([SaveFileName, ' & ', SaveFigureName ' has been saved in MATLAB current directory!'])
