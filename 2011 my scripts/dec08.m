%%%2011-12-11 revised
%%%dec08.m: revised from sep.m26.m

%%%John's new NMR list (2011-11)
logPfList=[NaN;-1.10000000000000;NaN;NaN;0.429410000000000;NaN;0.375410000000000;0.189240000000000;0.878810000000000;3.90090000000000;NaN;4.95240000000000;4.36830000000000;1.37450000000000;5.04190000000000;4.18730000000000;1.01040000000000;NaN;4.16250000000000;1.33000000000000;4.60330000000000;4.68360000000000;4.98910000000000;6.70860000000000;7.54850000000000;6.86040000000000;4.59870000000000;0.488430000000000;1.17030000000000;5.17320000000000;NaN;6.96000000000000;1.09490000000000;7.48470000000000;7.61880000000000;6.37000000000000;7.30250000000000;NaN;5.95000000000000;4.76560000000000;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;NaN;1.91960000000000;3.08060000000000;NaN;4.44210000000000;5.73310000000000;6.69750000000000;6.73490000000000;6.56940000000000;6.96530000000000;7.20000000000000;2.34760000000000;3.94720000000000;1.70400000000000;3.79000000000000;1.57990000000000;7.54930000000000;5.77700000000000;7.64570000000000;3.88210000000000;4.61430000000000;NaN;NaN;0.0606400000000000;NaN;2.93040000000000;4.35310000000000;NaN;NaN;2.75450000000000;4.61440000000000;4.91390000000000;5.08000000000000;7.48710000000000;7.65730000000000;7.51390000000000;7.53130000000000;7.64170000000000;4.41690000000000;1.25620000000000;5.74030000000000;0.280000000000000;7.32170000000000;7.48320000000000;7.60360000000000;7.13410000000000;7.35800000000000;7.22730000000000;7.17110000000000;7.38330000000000;7.12160000000000;6.56730000000000;7.03540000000000;5.77000000000000;5.90380000000000;4.38200000000000;NaN;NaN;NaN;NaN;NaN;NaN;1.70470000000000;2.89300000000000;NaN;4.68100000000000;0.198310000000000;1.25000000000000;6.08000000000000;6.29000000000000;4.23550000000000;4.75880000000000;NaN;6.04690000000000;4.79340000000000;6.51610000000000;6.21040000000000;5.51910000000000;5.01750000000000;5.05640000000000;5.23140000000000;2.56880000000000;5.04900000000000;4.80280000000000;4.49810000000000;NaN;NaN;0.474490000000000;0.0913190000000000;0.162110000000000;-0.216740000000000;0.316960000000000;-0.352490000000000;];

disp(' ')
disp('Make sure the variable "Data" is in workspace now (should made from MSDFIT result sheet)')
disp(' ')
AnalyName=input('Input AnalyName (e.g. "Dec SR5-PepFP_region123-149 MSDFIT_FL2_Algo3k25"): ','s');

HXtime=Data(1,3:end);

TPnum=size(HXtime,2);
AAnum=size(Data,1)-1;

rowNum=4;
colNum=4;

totalFigNum=ceil(AAnum/(rowNum*colNum));
for figNum=1:totalFigNum
    h=figure;
    n=0;
    for i=(rowNum*colNum)*(figNum-1)+1:(rowNum*colNum)*figNum
        if i>AAnum
            break
        end
        n=n+1;
        subplot(rowNum,colNum,n)
        
        
        %     semilogx(HXtime, Data(i+1,3)*ones(1,10),'y--')
        %     hold on
        
        semilogx(HXtime, Data(i+1,2)*ones(1,TPnum),'b--')
        hold on
        
        semilogx(HXtime, Data(i+1,3:TPnum+2),'r.:')
        hold on
        
        axis([10, 1e5, -0.05, 1.05])
        set(gca,'XTick',[100,1000,10000])
        set(gca,'XTickLabel',{'1e2','1e3','1e4'})
        
        if i==1
            title(['Residue # ',num2str(Data(i+1,1)),' (',num2str(logPfList(Data(i+1,1)),'%3.1f'),')'],'FontWeight','bold')
            ylabel('D%')
        else
            title(['# ',num2str(Data(i+1,1)),' (',num2str(logPfList(Data(i+1,1)),'%3.1f'),')'],'FontWeight','bold')
        end
        if i==AAnum
            xlabel('HX Time (sec)')
        end
    end
    SaveFigureName=['(',AnalyName,')_batAnalysis Summary_Part',num2str(figNum),'.fig'];
    saveas(figure(h),SaveFigureName)
    disp(' ')
    disp([SaveFigureName,' has been saved in MATLAB current directory!'])
end